<?php namespace akilli; /** @var callable $ƒ */?>
<section class="block block-list">
    <header>
        <h1><?=$ƒ('header');?></h1>
        <?= render('search');?>
    </header>
<?php if ($ƒ('data')):?>
    <?php foreach ($ƒ('data') as $id => $item):?>
    <article>
        <?php foreach ($ƒ('attributes') as $code => $attr):?>
            <?php $attr['action'] = 'list';?>
            <?php if (!$html = $attr['view']($attr, $item)) continue;?>
            <?php if ($code === 'name'):?>
        <header>
                <?php if (allowed('view')):?>
            <h2><a href="<?= url('*/view', ['id' => $id]);?>" title="<?= _('View this item');?>"><?=$html;?></a></h2>
                <?php else:?>
            <h2><?=$html;?></h2>
                <?php endif;?>
        </header>
            <?php else:?>
        <div class="attribute-<?=$attr['id'];?>">
            <?=$html;?>
        </div>
            <?php endif;?>
        <?php endforeach;?>
    </article>
        <?php endforeach;?>
    <?= render('pager');?>
<?php else:;?>
    <p><?= _('Nothing created yet');?></p>
<?php endif;?>
</section>
